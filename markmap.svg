<svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full leading-none markmap mm-jz7le0-1" style=""><style>.markmap{--markmap-max-width: 9999px;--markmap-a-color: #0097e6;--markmap-a-hover-color: #00a8ff;--markmap-code-bg: #f0f0f0;--markmap-code-color: #555;--markmap-highlight-bg: #ffeaa7;--markmap-table-border: 1px solid currentColor;--markmap-font: 300 16px/20px sans-serif;--markmap-circle-open-bg: #fff;--markmap-text-color: #333;--markmap-highlight-node-bg: #ff02;font:var(--markmap-font);color:var(--markmap-text-color)}.markmap-link{fill:none}.markmap-node&gt;circle{cursor:pointer}.markmap-foreign{display:inline-block}.markmap-foreign p{margin:0}.markmap-foreign a{color:var(--markmap-a-color)}.markmap-foreign a:hover{color:var(--markmap-a-hover-color)}.markmap-foreign code{padding:.25em;font-size:calc(1em - 2px);color:var(--markmap-code-color);background-color:var(--markmap-code-bg);border-radius:2px}.markmap-foreign pre{margin:0}.markmap-foreign pre&gt;code{display:block}.markmap-foreign del{text-decoration:line-through}.markmap-foreign em{font-style:italic}.markmap-foreign strong{font-weight:700}.markmap-foreign mark{background:var(--markmap-highlight-bg)}.markmap-foreign table,.markmap-foreign th,.markmap-foreign td{border-collapse:collapse;border:var(--markmap-table-border)}.markmap-foreign img{display:inline-block}.markmap-foreign svg{fill:currentColor}.markmap-foreign&gt;div{width:var(--markmap-max-width);text-align:left}.markmap-foreign&gt;div&gt;div{display:inline-block}.markmap-highlight rect{fill:var(--markmap-highlight-node-bg)}.markmap-dark .markmap{--markmap-code-bg: #1a1b26;--markmap-code-color: #ddd;--markmap-circle-open-bg: #444;--markmap-text-color: #eee}</style><g transform="translate(233.3988635770586,518.8327983450548) scale(0.589799748127427)"><path class="markmap-link" data-depth="4" data-path="1.3.4.5" d="M446,-752.555C486,-752.555,486,-779.836,526,-779.836" stroke-width="1.1875" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="4" data-path="1.3.4.6" d="M446,-752.555C486,-752.555,486,-752.648,526,-752.648" stroke-width="1.1875" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="4" data-path="1.3.4.7" d="M446,-752.555C486,-752.555,486,-725.461,526,-725.461" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.3.8.9" d="M455,-679.586C495,-679.586,495,-693.273,535,-693.273" stroke-width="1.1875" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="4" data-path="1.3.8.10" d="M455,-679.586C495,-679.586,495,-666.086,535,-666.086" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.11.12.13" d="M636,-620.211C676,-620.211,676,-633.898,716,-633.898" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.11.12.14" d="M636,-620.211C676,-620.211,676,-606.711,716,-606.711" stroke-width="1.1875" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="4" data-path="1.11.15.16" d="M558,-560.836C598,-560.836,598,-574.523,638,-574.523" stroke-width="1.1875" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="4" data-path="1.11.15.17" d="M558,-560.836C598,-560.836,598,-547.336,638,-547.336" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.11.18.19" d="M602,-501.461C642,-501.461,642,-515.148,682,-515.148" stroke-width="1.1875" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="4" data-path="1.11.18.20" d="M602,-501.461C642,-501.461,642,-487.961,682,-487.961" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.11.21.22" d="M749,-428.492C789,-428.492,789,-455.773,829,-455.773" stroke-width="1.1875" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="4" data-path="1.11.21.23" d="M749,-428.492C789,-428.492,789,-428.586,829,-428.586" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.11.21.24" d="M749,-428.492C789,-428.492,789,-401.398,829,-401.398" stroke-width="1.1875" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="4" data-path="1.25.26.27" d="M425,-341.93C465,-341.93,465,-369.211,505,-369.211" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.25.26.28" d="M425,-341.93C465,-341.93,465,-342.023,505,-342.023" stroke-width="1.1875" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="4" data-path="1.25.26.29" d="M425,-341.93C465,-341.93,465,-314.836,505,-314.836" stroke-width="1.1875" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="4" data-path="1.25.30.31" d="M508,-255.367C548,-255.367,548,-282.648,588,-282.648" stroke-width="1.1875" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="4" data-path="1.25.30.32" d="M508,-255.367C548,-255.367,548,-255.461,588,-255.461" stroke-width="1.1875" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="4" data-path="1.25.30.33" d="M508,-255.367C548,-255.367,548,-228.273,588,-228.273" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.25.34.35" d="M393,-182.398C433,-182.398,433,-196.086,473,-196.086" stroke-width="1.1875" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="4" data-path="1.25.34.36" d="M393,-182.398C433,-182.398,433,-168.898,473,-168.898" stroke-width="1.1875" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="4" data-path="1.37.38.39" d="M489,-123.023C529,-123.023,529,-136.711,569,-136.711" stroke-width="1.1875" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="4" data-path="1.37.38.40" d="M489,-123.023C529,-123.023,529,-109.523,569,-109.523" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.37.41.42" d="M417,-50.055C457,-50.055,457,-77.336,497,-77.336" stroke-width="1.1875" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="4" data-path="1.37.41.43" d="M417,-50.055C457,-50.055,457,-50.148,497,-50.148" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.37.41.44" d="M417,-50.055C457,-50.055,457,-22.961,497,-22.961" stroke-width="1.1875" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="4" data-path="1.37.45.46" d="M417,22.914C457,22.914,457,9.227,497,9.227" stroke-width="1.1875" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="4" data-path="1.37.45.47" d="M417,22.914C457,22.914,457,36.414,497,36.414" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.48.49.50" d="M471,82.289C511,82.289,511,68.602,551,68.602" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.48.49.51" d="M471,82.289C511,82.289,511,95.789,551,95.789" stroke-width="1.1875" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="4" data-path="1.48.52.53" d="M457,141.664C497,141.664,497,127.977,537,127.977" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.48.52.54" d="M457,141.664C497,141.664,497,155.164,537,155.164" stroke-width="1.1875" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="4" data-path="1.55.56.57" d="M452,201.039C492,201.039,492,187.352,532,187.352" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.55.56.58" d="M452,201.039C492,201.039,492,214.539,532,214.539" stroke-width="1.1875" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="4" data-path="1.55.59.60" d="M453,260.414C493,260.414,493,246.727,533,246.727" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.55.59.61" d="M453,260.414C493,260.414,493,273.914,533,273.914" stroke-width="1.1875" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="4" data-path="1.55.62.63" d="M457,319.789C497,319.789,497,306.102,537,306.102" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.55.62.64" d="M457,319.789C497,319.789,497,333.289,537,333.289" stroke-width="1.1875" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="4" data-path="1.65.66.67" d="M393,379.164C433,379.164,433,365.477,473,365.477" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.65.66.68" d="M393,379.164C433,379.164,433,392.664,473,392.664" stroke-width="1.1875" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="4" data-path="1.65.69.70" d="M425,452.133C465,452.133,465,424.852,505,424.852" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.65.69.71" d="M425,452.133C465,452.133,465,452.039,505,452.039" stroke-width="1.1875" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="4" data-path="1.65.69.72" d="M425,452.133C465,452.133,465,479.227,505,479.227" stroke-width="1.1875" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="4" data-path="1.73.74.75" d="M425,538.695C465,538.695,465,511.414,505,511.414" stroke-width="1.1875" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="4" data-path="1.73.74.76" d="M425,538.695C465,538.695,465,538.602,505,538.602" stroke-width="1.1875" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="4" data-path="1.73.74.77" d="M425,538.695C465,538.695,465,565.789,505,565.789" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.73.78.79" d="M425,611.664C465,611.664,465,597.977,505,597.977" stroke-width="1.1875" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="4" data-path="1.73.78.80" d="M425,611.664C465,611.664,465,625.164,505,625.164" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.73.81.82" d="M441,671.039C481,671.039,481,657.352,521,657.352" stroke-width="1.1875" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="4" data-path="1.73.81.83" d="M441,671.039C481,671.039,481,684.539,521,684.539" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.84.85.86" d="M473,771.195C513,771.195,513,716.727,553,716.727" stroke-width="1.1875" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="4" data-path="1.84.85.87" d="M473,771.195C513,771.195,513,743.914,553,743.914" stroke-width="1.1875" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="4" data-path="1.84.85.88" d="M473,771.195C513,771.195,513,771.102,553,771.102" stroke-width="1.1875" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="4" data-path="1.84.85.89" d="M473,771.195C513,771.195,513,798.289,553,798.289" stroke-width="1.1875" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="4" data-path="1.84.85.90" d="M473,771.195C513,771.195,513,825.477,553,825.477" stroke-width="1.1875" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="4" data-path="1.84.91.92" d="M489,898.539C529,898.539,529,857.664,569,857.664" stroke-width="1.1875" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="4" data-path="1.84.91.93" d="M489,898.539C529,898.539,529,884.852,569,884.852" stroke-width="1.1875" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="4" data-path="1.84.91.94" d="M489,898.539C529,898.539,529,912.039,569,912.039" stroke-width="1.1875" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="4" data-path="1.84.91.95" d="M489,898.539C529,898.539,529,939.227,569,939.227" stroke-width="1.1875" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="2" data-path="1.2" d="M0,1.25C40,1.25,40,-812.305,80,-812.305" stroke-width="1.75" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="3" data-path="1.3.4" d="M238,-715.883C278,-715.883,278,-752.555,318,-752.555" stroke-width="1.375" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="3" data-path="1.3.8" d="M238,-715.883C278,-715.883,278,-679.586,318,-679.586" stroke-width="1.375" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="3" data-path="1.11.12" d="M341,-524.164C381,-524.164,381,-620.211,421,-620.211" stroke-width="1.375" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="3" data-path="1.11.15" d="M341,-524.164C381,-524.164,381,-560.836,421,-560.836" stroke-width="1.375" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="3" data-path="1.11.18" d="M341,-524.164C381,-524.164,381,-501.461,421,-501.461" stroke-width="1.375" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="3" data-path="1.11.21" d="M341,-524.164C381,-524.164,381,-428.492,421,-428.492" stroke-width="1.375" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="3" data-path="1.25.26" d="M208,-261.977C248,-261.977,248,-341.93,288,-341.93" stroke-width="1.375" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="3" data-path="1.25.30" d="M208,-261.977C248,-261.977,248,-255.367,288,-255.367" stroke-width="1.375" stroke="rgb(255, 127, 14)"/><path class="markmap-link" data-depth="3" data-path="1.25.34" d="M208,-261.977C248,-261.977,248,-182.398,288,-182.398" stroke-width="1.375" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="3" data-path="1.37.38" d="M232,-49.867C272,-49.867,272,-123.023,312,-123.023" stroke-width="1.375" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="3" data-path="1.37.41" d="M232,-49.867C272,-49.867,272,-50.055,312,-50.055" stroke-width="1.375" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="3" data-path="1.37.45" d="M232,-49.867C272,-49.867,272,22.914,312,22.914" stroke-width="1.375" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="3" data-path="1.48.49" d="M240,112.164C280,112.164,280,82.289,320,82.289" stroke-width="1.375" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="3" data-path="1.48.52" d="M240,112.164C280,112.164,280,141.664,320,141.664" stroke-width="1.375" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="3" data-path="1.55.56" d="M240,260.602C280,260.602,280,201.039,320,201.039" stroke-width="1.375" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="3" data-path="1.55.59" d="M240,260.602C280,260.602,280,260.414,320,260.414" stroke-width="1.375" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="3" data-path="1.55.62" d="M240,260.602C280,260.602,280,319.789,320,319.789" stroke-width="1.375" stroke="rgb(214, 39, 40)"/><path class="markmap-link" data-depth="3" data-path="1.65.66" d="M208,415.836C248,415.836,248,379.164,288,379.164" stroke-width="1.375" stroke="rgb(127, 127, 127)"/><path class="markmap-link" data-depth="3" data-path="1.65.69" d="M208,415.836C248,415.836,248,452.133,288,452.133" stroke-width="1.375" stroke="rgb(31, 119, 180)"/><path class="markmap-link" data-depth="3" data-path="1.73.74" d="M224,605.055C264,605.055,264,538.695,304,538.695" stroke-width="1.375" stroke="rgb(140, 86, 75)"/><path class="markmap-link" data-depth="3" data-path="1.73.78" d="M224,605.055C264,605.055,264,611.664,304,611.664" stroke-width="1.375" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="3" data-path="1.73.81" d="M224,605.055C264,605.055,264,671.039,304,671.039" stroke-width="1.375" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="3" data-path="1.84.85" d="M256,835.055C296,835.055,296,771.195,336,771.195" stroke-width="1.375" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="3" data-path="1.84.91" d="M256,835.055C296,835.055,296,898.539,336,898.539" stroke-width="1.375" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="2" data-path="1.3" d="M0,1.25C40,1.25,40,-715.883,80,-715.883" stroke-width="1.75" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="2" data-path="1.11" d="M0,1.25C40,1.25,40,-524.164,80,-524.164" stroke-width="1.75" stroke="rgb(44, 160, 44)"/><path class="markmap-link" data-depth="2" data-path="1.25" d="M0,1.25C40,1.25,40,-261.977,80,-261.977" stroke-width="1.75" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="2" data-path="1.37" d="M0,1.25C40,1.25,40,-49.867,80,-49.867" stroke-width="1.75" stroke="rgb(188, 189, 34)"/><path class="markmap-link" data-depth="2" data-path="1.48" d="M0,1.25C40,1.25,40,112.164,80,112.164" stroke-width="1.75" stroke="rgb(23, 190, 207)"/><path class="markmap-link" data-depth="2" data-path="1.55" d="M0,1.25C40,1.25,40,260.602,80,260.602" stroke-width="1.75" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="2" data-path="1.65" d="M0,1.25C40,1.25,40,415.836,80,415.836" stroke-width="1.75" stroke="rgb(227, 119, 194)"/><path class="markmap-link" data-depth="2" data-path="1.73" d="M0,1.25C40,1.25,40,605.055,80,605.055" stroke-width="1.75" stroke="rgb(148, 103, 189)"/><path class="markmap-link" data-depth="2" data-path="1.84" d="M0,1.25C40,1.25,40,835.055,80,835.055" stroke-width="1.75" stroke="rgb(140, 86, 75)"/><g class="markmap-highlight"/><g data-depth="2" data-path="1.2" class="markmap-node" transform="translate(80, -834.1796875)"><line stroke="#ff7f0e" stroke-width="1.75" x1="-1" x2="393" y1="21.875" y2="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="375" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">后端工程师面试 - Stripe知识体系大纲（高频考点版）</div></div></foreignObject></g><g data-depth="4" data-path="1.3.4.5" class="markmap-node" transform="translate(526, -801.4296875)"><line stroke="#e377c2" stroke-width="1.1875" x1="-1" x2="522" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="504" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="8,9">RESTful API：资源对象模型、版本控制（URL指定版本）、统一响应格式</p></div></div></foreignObject></g><g data-depth="4" data-path="1.3.4.6" class="markmap-node" transform="translate(526, -774.2421875)"><line stroke="#7f7f7f" stroke-width="1.1875" x1="-1" x2="526" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="508" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="10,11">SDK架构：服务端SDK（Python/Java等）、客户端SDK、版本兼容与管理</p></div></div></foreignObject></g><g data-depth="4" data-path="1.3.4.7" class="markmap-node" transform="translate(526, -747.0546875)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="504" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="486" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="12,13">核心数据模型关系：Customer → PaymentMethod → PaymentIntent</p></div></div></foreignObject></g><g data-depth="3" data-path="1.3.4" class="markmap-node" transform="translate(318, -774.2421875)"><line stroke="#8c564b" stroke-width="1.375" x1="-1" x2="130" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#8c564b" fill="var(--markmap-circle-open-bg)" cx="128" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="112" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">1.1 API架构设计</div></div></foreignObject></g><g data-depth="4" data-path="1.3.8.9" class="markmap-node" transform="translate(535, -714.8671875)"><line stroke="#1f77b4" stroke-width="1.1875" x1="-1" x2="477" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="459" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="16,17">传统方式（已废弃）：Charge对象、仅支持即时支付、无法预授权</p></div></div></foreignObject></g><g data-depth="4" data-path="1.3.8.10" class="markmap-node" transform="translate(535, -687.6796875)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="565" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="547" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="18,19">现代方式（推荐）：PaymentIntent对象、支持预授权、确认流程、适配多场景</p></div></div></foreignObject></g><g data-depth="3" data-path="1.3.8" class="markmap-node" transform="translate(318, -701.2734375)"><line stroke="#17becf" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#17becf" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">1.2 支付流程演进</div></div></foreignObject></g><g data-depth="2" data-path="1.3" class="markmap-node" transform="translate(80, -737.7578125)"><line stroke="#9467bd" stroke-width="1.75" x1="-1" x2="160" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#9467bd" fill="var(--markmap-circle-open-bg)" cx="158" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="142" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">一、Stripe 核心架构</div></div></foreignObject></g><g data-depth="4" data-path="1.11.12.13" class="markmap-node" transform="translate(716, -655.4921875)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="621" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="603" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="24,25">生命周期：创建（created）→ 确认（requires_confirmation）→ 处理中 → 成功/失败</p></div></div></foreignObject></g><g data-depth="4" data-path="1.11.12.14" class="markmap-node" transform="translate(716, -628.3046875)"><line stroke="#8c564b" stroke-width="1.1875" x1="-1" x2="680" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="662" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="26,27">关键属性：amount（金额，最小单位）、currency（币种）、payment_method、client_secret</p></div></div></foreignObject></g><g data-depth="3" data-path="1.11.12" class="markmap-node" transform="translate(421, -641.8984375)"><line stroke="#d62728" stroke-width="1.375" x1="-1" x2="217" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#d62728" fill="var(--markmap-circle-open-bg)" cx="215" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="199" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">2.1 PaymentIntent 核心概念</div></div></foreignObject></g><g data-depth="4" data-path="1.11.15.16" class="markmap-node" transform="translate(638, -596.1171875)"><line stroke="#7f7f7f" stroke-width="1.1875" x1="-1" x2="510" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="492" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="30,31">自动确认（automatic）：Stripe自动处理，适配大多数无额外验证场景</p></div></div></foreignObject></g><g data-depth="4" data-path="1.11.15.17" class="markmap-node" transform="translate(638, -568.9296875)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="555" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="537" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="32,33">手动确认（manual）：客户端调用confirmCardPayment，灵活控制确认时机</p></div></div></foreignObject></g><g data-depth="3" data-path="1.11.15" class="markmap-node" transform="translate(421, -582.5234375)"><line stroke="#e377c2" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#e377c2" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">2.2 支付确认流程</div></div></foreignObject></g><g data-depth="4" data-path="1.11.18.19" class="markmap-node" transform="translate(682, -536.7421875)"><line stroke="#1f77b4" stroke-width="1.1875" x1="-1" x2="349" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="331" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="36,37">触发条件：卡片要求验证、Stripe风险评估触发</p></div></div></foreignObject></g><g data-depth="4" data-path="1.11.18.20" class="markmap-node" transform="translate(682, -509.5546875)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="531" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="513" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="38,39">处理流程：requires_action → 客户端handleCardAction → 再次确认支付</p></div></div></foreignObject></g><g data-depth="3" data-path="1.11.18" class="markmap-node" transform="translate(421, -523.1484375)"><line stroke="#17becf" stroke-width="1.375" x1="-1" x2="183" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#17becf" fill="var(--markmap-circle-open-bg)" cx="181" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="165" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">2.3 3D Secure 验证流程</div></div></foreignObject></g><g data-depth="4" data-path="1.11.21.22" class="markmap-node" transform="translate(829, -477.3671875)"><line stroke="#d62728" stroke-width="1.1875" x1="-1" x2="421" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="403" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="42,43">PaymentIntent：立即执行支付，支持预授权、3D Secure</p></div></div></foreignObject></g><g data-depth="4" data-path="1.11.21.23" class="markmap-node" transform="translate(829, -450.1796875)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="431" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="413" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="44,45">SetupIntent：仅保存支付方式（不扣款），供未来支付使用</p></div></div></foreignObject></g><g data-depth="4" data-path="1.11.21.24" class="markmap-node" transform="translate(829, -422.9921875)"><line stroke="#8c564b" stroke-width="1.1875" x1="-1" x2="469" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="451" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="46,47">Charge：旧版即时支付对象，无预授权、无多步骤确认，已废弃</p></div></div></foreignObject></g><g data-depth="3" data-path="1.11.21" class="markmap-node" transform="translate(421, -450.1796875)"><line stroke="#2ca02c" stroke-width="1.375" x1="-1" x2="330" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#2ca02c" fill="var(--markmap-circle-open-bg)" cx="328" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="312" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">2.4 PaymentIntent vs SetupIntent vs Charge</div></div></foreignObject></g><g data-depth="2" data-path="1.11" class="markmap-node" transform="translate(80, -546.0390625)"><line stroke="#2ca02c" stroke-width="1.75" x1="-1" x2="263" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#2ca02c" fill="var(--markmap-circle-open-bg)" cx="261" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="245" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">二、支付流程（Payment Intents）</div></div></foreignObject></g><g data-depth="4" data-path="1.25.26.27" class="markmap-node" transform="translate(505, -390.8046875)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="583" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="565" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="52,53">核心对象：Subscription（订阅）、SubscriptionItem（订阅项）、Status（状态）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.25.26.28" class="markmap-node" transform="translate(505, -363.6171875)"><line stroke="#17becf" stroke-width="1.1875" x1="-1" x2="556" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="538" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="54,55">价格模型：Product（产品）→ Price（价格）→ Recurring（计费周期配置）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.25.26.29" class="markmap-node" transform="translate(505, -336.4296875)"><line stroke="#1f77b4" stroke-width="1.1875" x1="-1" x2="729" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="711" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="56,57">计费周期：current_period（当前周期）、trial_period（试用期）、billing_cycle_anchor（计费锚点）</p></div></div></foreignObject></g><g data-depth="3" data-path="1.25.26" class="markmap-node" transform="translate(288, -363.6171875)"><line stroke="#7f7f7f" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#7f7f7f" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">3.1 订阅核心概念</div></div></foreignObject></g><g data-depth="4" data-path="1.25.30.31" class="markmap-node" transform="translate(588, -304.2421875)"><line stroke="#2ca02c" stroke-width="1.1875" x1="-1" x2="440" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="422" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="60,61">核心原理：订阅升级/降级时，按剩余周期时间比例计算差价</p></div></div></foreignObject></g><g data-depth="4" data-path="1.25.30.32" class="markmap-node" transform="translate(588, -277.0546875)"><line stroke="#d62728" stroke-width="1.1875" x1="-1" x2="680" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="662" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="62,63">常用策略：create_prorations（默认，生成差价账单）、none（无差价）、always（强制生成）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.25.30.33" class="markmap-node" transform="translate(588, -249.8671875)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="443" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="425" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="64,65">关键操作：使用API预览计费变化（preview），避免用户纠纷</p></div></div></foreignObject></g><g data-depth="3" data-path="1.25.30" class="markmap-node" transform="translate(288, -277.0546875)"><line stroke="#ff7f0e" stroke-width="1.375" x1="-1" x2="222" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#ff7f0e" fill="var(--markmap-circle-open-bg)" cx="220" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="204" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">3.2 Proration（按比例计费）</div></div></foreignObject></g><g data-depth="4" data-path="1.25.34.35" class="markmap-node" transform="translate(473, -217.6796875)"><line stroke="#e377c2" stroke-width="1.1875" x1="-1" x2="450" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="432" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="68,69">基础操作：暂停（pause）、取消（cancel）、重启（resume）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.25.34.36" class="markmap-node" transform="translate(473, -190.4921875)"><line stroke="#7f7f7f" stroke-width="1.1875" x1="-1" x2="386" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="368" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="70,71">并发处理：避免重复创建订阅，通过幂等性保证唯一</p></div></div></foreignObject></g><g data-depth="3" data-path="1.25.34" class="markmap-node" transform="translate(288, -204.0859375)"><line stroke="#8c564b" stroke-width="1.375" x1="-1" x2="107" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#8c564b" fill="var(--markmap-circle-open-bg)" cx="105" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="89" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">3.3 订阅管理</div></div></foreignObject></g><g data-depth="2" data-path="1.25" class="markmap-node" transform="translate(80, -283.8515625)"><line stroke="#e377c2" stroke-width="1.75" x1="-1" x2="130" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#e377c2" fill="var(--markmap-circle-open-bg)" cx="128" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="112" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">三、订阅与计费</div></div></foreignObject></g><g data-depth="4" data-path="1.37.38.39" class="markmap-node" transform="translate(569, -158.3046875)"><line stroke="#1f77b4" stroke-width="1.1875" x1="-1" x2="436" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="418" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="76,77">核心作用：Stripe异步推送事件到业务服务器，避免轮询API</p></div></div></foreignObject></g><g data-depth="4" data-path="1.37.38.40" class="markmap-node" transform="translate(569, -131.1171875)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="514" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="496" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="78,79">事件驱动：基于事件触发业务逻辑（如支付成功回调、订阅过期提醒）</p></div></div></foreignObject></g><g data-depth="3" data-path="1.37.38" class="markmap-node" transform="translate(312, -144.7109375)"><line stroke="#17becf" stroke-width="1.375" x1="-1" x2="179" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#17becf" fill="var(--markmap-circle-open-bg)" cx="177" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="161" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">4.1 Webhook 核心原理</div></div></foreignObject></g><g data-depth="4" data-path="1.37.41.42" class="markmap-node" transform="translate(497, -98.9296875)"><line stroke="#d62728" stroke-width="1.1875" x1="-1" x2="481" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="463" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="82,83">验证原理：使用Stripe提供的Webhook密钥，对事件签名进行校验</p></div></div></foreignObject></g><g data-depth="4" data-path="1.37.41.43" class="markmap-node" transform="translate(497, -71.7421875)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="585" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="567" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="84,85">验证步骤：提取签名（Stripe-Signature）→ 提取时间戳 → 拼接数据 → 校验签名</p></div></div></foreignObject></g><g data-depth="4" data-path="1.37.41.44" class="markmap-node" transform="translate(497, -44.5546875)"><line stroke="#8c564b" stroke-width="1.1875" x1="-1" x2="519" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="501" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="86,87">安全意义：防止伪造Webhook事件，避免业务异常（如虚假支付成功）</p></div></div></foreignObject></g><g data-depth="3" data-path="1.37.41" class="markmap-node" transform="translate(312, -71.7421875)"><line stroke="#2ca02c" stroke-width="1.375" x1="-1" x2="107" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#2ca02c" fill="var(--markmap-circle-open-bg)" cx="105" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="89" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">4.2 签名验证</div></div></foreignObject></g><g data-depth="4" data-path="1.37.45.46" class="markmap-node" transform="translate(497, -12.3671875)"><line stroke="#7f7f7f" stroke-width="1.1875" x1="-1" x2="708" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="690" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="90,91">核心事件类型：payment_intent.<em>（支付相关）、invoice.</em>（账单相关）、subscription.*（订阅相关）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.37.45.47" class="markmap-node" transform="translate(497, 14.8203125)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="543" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="525" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="92,93">处理策略：幂等性设计（用event.id去重）、异步处理、Stripe重试机制适配</p></div></div></foreignObject></g><g data-depth="3" data-path="1.37.45" class="markmap-node" transform="translate(312, 1.2265625)"><line stroke="#e377c2" stroke-width="1.375" x1="-1" x2="107" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#e377c2" fill="var(--markmap-circle-open-bg)" cx="105" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="89" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">4.3 事件处理</div></div></foreignObject></g><g data-depth="2" data-path="1.37" class="markmap-node" transform="translate(80, -71.7421875)"><line stroke="#bcbd22" stroke-width="1.75" x1="-1" x2="154" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#bcbd22" fill="var(--markmap-circle-open-bg)" cx="152" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="136" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">四、Webhook 机制</div></div></foreignObject></g><g data-depth="4" data-path="1.48.49.50" class="markmap-node" transform="translate(551, 47.0078125)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="691" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="673" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="98,99">核心错误类型：CardError（卡片错误）、APIError（API调用错误）、RateLimitError（限流错误）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.48.49.51" class="markmap-node" transform="translate(551, 74.1953125)"><line stroke="#2ca02c" stroke-width="1.1875" x1="-1" x2="670" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="652" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="100,101">错误信息结构：type（类型）、code（错误码）、message（提示）、decline_code（拒绝码）</p></div></div></foreignObject></g><g data-depth="3" data-path="1.48.49" class="markmap-node" transform="translate(320, 60.6015625)"><line stroke="#1f77b4" stroke-width="1.375" x1="-1" x2="153" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#1f77b4" fill="var(--markmap-circle-open-bg)" cx="151" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="135" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">5.1 Stripe 错误体系</div></div></foreignObject></g><g data-depth="4" data-path="1.48.52.53" class="markmap-node" transform="translate(537, 106.3828125)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="728" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="710" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="104,105">卡片拒绝：insufficient_funds（余额不足）、card_declined（卡片被拒）、expired_card（卡片过期）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.48.52.54" class="markmap-node" transform="translate(537, 133.5703125)"><line stroke="#8c564b" stroke-width="1.1875" x1="-1" x2="706" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="688" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="106,107">最佳实践：try-catch包裹API调用、优雅降级（如跳转备用支付方式）、详细日志记录（便于排查）</p></div></div></foreignObject></g><g data-depth="3" data-path="1.48.52" class="markmap-node" transform="translate(320, 119.9765625)"><line stroke="#d62728" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#d62728" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">5.2 常见错误处理</div></div></foreignObject></g><g data-depth="2" data-path="1.48" class="markmap-node" transform="translate(80, 90.2890625)"><line stroke="#17becf" stroke-width="1.75" x1="-1" x2="162" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#17becf" fill="var(--markmap-circle-open-bg)" cx="160" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="144" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">五、错误与异常处理</div></div></foreignObject></g><g data-depth="4" data-path="1.55.56.57" class="markmap-node" transform="translate(532, 165.7578125)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="766" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="748" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="112,113">密钥类型：Publishable Key（客户端，公开）、Secret Key（服务端，保密）、Restricted Keys（权限管控）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.55.56.58" class="markmap-node" transform="translate(532, 192.9453125)"><line stroke="#17becf" stroke-width="1.1875" x1="-1" x2="520" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="502" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="114,115">安全实践：环境变量存储密钥、定期轮换密钥、不暴露密钥到前端/日志</p></div></div></foreignObject></g><g data-depth="3" data-path="1.55.56" class="markmap-node" transform="translate(320, 179.3515625)"><line stroke="#7f7f7f" stroke-width="1.375" x1="-1" x2="134" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#7f7f7f" fill="var(--markmap-circle-open-bg)" cx="132" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="116" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">6.1 API 密钥管理</div></div></foreignObject></g><g data-depth="4" data-path="1.55.59.60" class="markmap-node" transform="translate(533, 225.1328125)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="538" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="520" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="118,119">合规要求：不直接处理/存储原始卡片数据，依托Stripe Elements规避风险</p></div></div></foreignObject></g><g data-depth="4" data-path="1.55.59.61" class="markmap-node" transform="translate(533, 252.3203125)"><line stroke="#2ca02c" stroke-width="1.1875" x1="-1" x2="609" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="591" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="120,121">Stripe Elements优势：自带PCI DSS Level 1认证、自动处理卡片验证、降低合规成本</p></div></div></foreignObject></g><g data-depth="3" data-path="1.55.59" class="markmap-node" transform="translate(320, 238.7265625)"><line stroke="#1f77b4" stroke-width="1.375" x1="-1" x2="135" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#1f77b4" fill="var(--markmap-circle-open-bg)" cx="133" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="117" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">6.2 PCI DSS 合规</div></div></foreignObject></g><g data-depth="4" data-path="1.55.62.63" class="markmap-node" transform="translate(537, 284.5078125)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="666" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="648" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="124,125">幂等性实现：使用idempotency_key参数，保证重复调用API不产生重复业务（如重复支付）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.55.62.64" class="markmap-node" transform="translate(537, 311.6953125)"><line stroke="#8c564b" stroke-width="1.1875" x1="-1" x2="472" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="454" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="126,127">并发处理：避免同一用户同时发起多笔支付，通过锁/幂等键控制</p></div></div></foreignObject></g><g data-depth="3" data-path="1.55.62" class="markmap-node" transform="translate(320, 298.1015625)"><line stroke="#d62728" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#d62728" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">6.3 幂等性与并发</div></div></foreignObject></g><g data-depth="2" data-path="1.55" class="markmap-node" transform="translate(80, 238.7265625)"><line stroke="#e377c2" stroke-width="1.75" x1="-1" x2="162" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#e377c2" fill="var(--markmap-circle-open-bg)" cx="160" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="144" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">六、安全与签名验证</div></div></foreignObject></g><g data-depth="4" data-path="1.65.66.67" class="markmap-node" transform="translate(473, 343.8828125)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="644" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="626" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="132,133">常用测试卡：4242424242424242（无验证成功）、4000002500003155（触发3D Secure）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.65.66.68" class="markmap-node" transform="translate(473, 371.0703125)"><line stroke="#17becf" stroke-width="1.1875" x1="-1" x2="730" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="712" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="134,135">Stripe CLI工具：stripe login（登录）、stripe listen（监听Webhook）、stripe trigger（触发测试事件）</p></div></div></foreignObject></g><g data-depth="3" data-path="1.65.66" class="markmap-node" transform="translate(288, 357.4765625)"><line stroke="#7f7f7f" stroke-width="1.375" x1="-1" x2="107" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#7f7f7f" fill="var(--markmap-circle-open-bg)" cx="105" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="89" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">7.1 测试环境</div></div></foreignObject></g><g data-depth="4" data-path="1.65.69.70" class="markmap-node" transform="translate(505, 403.2578125)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="503" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="485" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="138,139">前置检查：切换为生产密钥、配置生产环境Webhook、关闭测试模式</p></div></div></foreignObject></g><g data-depth="4" data-path="1.65.69.71" class="markmap-node" transform="translate(505, 430.4453125)"><line stroke="#2ca02c" stroke-width="1.1875" x1="-1" x2="410" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="392" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="140,141">监控指标：API成功率、响应时间、错误率、支付转化率</p></div></div></foreignObject></g><g data-depth="4" data-path="1.65.69.72" class="markmap-node" transform="translate(505, 457.6328125)"><line stroke="#d62728" stroke-width="1.1875" x1="-1" x2="450" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="432" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="142,143">应急处理：配置错误告警、预留回滚方案、密钥泄露应急措施</p></div></div></foreignObject></g><g data-depth="3" data-path="1.65.69" class="markmap-node" transform="translate(288, 430.4453125)"><line stroke="#1f77b4" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#1f77b4" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">7.2 上线检查清单</div></div></foreignObject></g><g data-depth="2" data-path="1.65" class="markmap-node" transform="translate(80, 393.9609375)"><line stroke="#e377c2" stroke-width="1.75" x1="-1" x2="130" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#e377c2" fill="var(--markmap-circle-open-bg)" cx="128" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="112" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">七、测试与上线</div></div></foreignObject></g><g data-depth="4" data-path="1.73.74.75" class="markmap-node" transform="translate(505, 489.8203125)"><line stroke="#e377c2" stroke-width="1.1875" x1="-1" x2="476" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="458" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="148,149">退款流程：创建Refund对象、异步处理、支持部分退款/全额退款</p></div></div></foreignObject></g><g data-depth="4" data-path="1.73.74.76" class="markmap-node" transform="translate(505, 517.0078125)"><line stroke="#7f7f7f" stroke-width="1.1875" x1="-1" x2="536" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="518" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="150,151">争议处理：Dispute对象（争议发起）、证据提交、争议状态管理（赢/输）</p></div></div></foreignObject></g><g data-depth="4" data-path="1.73.74.77" class="markmap-node" transform="translate(505, 544.1953125)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="386" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="368" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="152,153">退款拒付：区分主动退款与银行拒付，避免双重损失</p></div></div></foreignObject></g><g data-depth="3" data-path="1.73.74" class="markmap-node" transform="translate(304, 517.0078125)"><line stroke="#8c564b" stroke-width="1.375" x1="-1" x2="123" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#8c564b" fill="var(--markmap-circle-open-bg)" cx="121" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="105" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">8.1 退款与争议</div></div></foreignObject></g><g data-depth="4" data-path="1.73.78.79" class="markmap-node" transform="translate(505, 576.3828125)"><line stroke="#1f77b4" stroke-width="1.1875" x1="-1" x2="502" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="484" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="156,157">多币种支持：PaymentIntent指定currency，Stripe自动处理汇率转换</p></div></div></foreignObject></g><g data-depth="4" data-path="1.73.78.80" class="markmap-node" transform="translate(505, 603.5703125)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="554" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="536" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="158,159">最佳实践：使用金额最小单位（如分）、避免浮点数计算、显示当地币种金额</p></div></div></foreignObject></g><g data-depth="3" data-path="1.73.78" class="markmap-node" transform="translate(304, 589.9765625)"><line stroke="#17becf" stroke-width="1.375" x1="-1" x2="123" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#17becf" fill="var(--markmap-circle-open-bg)" cx="121" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="105" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">8.2 多币种支付</div></div></foreignObject></g><g data-depth="4" data-path="1.73.81.82" class="markmap-node" transform="translate(521, 635.7578125)"><line stroke="#d62728" stroke-width="1.1875" x1="-1" x2="397" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="379" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="162,163">一次性支付：直接使用PaymentIntent，简化确认流程</p></div></div></foreignObject></g><g data-depth="4" data-path="1.73.81.83" class="markmap-node" transform="translate(521, 662.9453125)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="497" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="479" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="164,165">订阅+单次付费：结合Subscription与PaymentIntent，灵活适配业务</p></div></div></foreignObject></g><g data-depth="3" data-path="1.73.81" class="markmap-node" transform="translate(304, 649.3515625)"><line stroke="#2ca02c" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#2ca02c" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">8.3 高频业务适配</div></div></foreignObject></g><g data-depth="2" data-path="1.73" class="markmap-node" transform="translate(80, 583.1796875)"><line stroke="#9467bd" stroke-width="1.75" x1="-1" x2="146" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#9467bd" fill="var(--markmap-circle-open-bg)" cx="144" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="128" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">八、常见业务场景</div></div></foreignObject></g><g data-depth="4" data-path="1.84.85.86" class="markmap-node" transform="translate(553, 695.1328125)"><line stroke="#7f7f7f" stroke-width="1.1875" x1="-1" x2="875" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="857" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="170,171">PaymentIntent vs Charge：Charge是旧版即时支付，无预授权；PaymentIntent支持预授权、3D Secure，是当前推荐方案</p></div></div></foreignObject></g><g data-depth="4" data-path="1.84.85.87" class="markmap-node" transform="translate(553, 722.3203125)"><line stroke="#bcbd22" stroke-width="1.1875" x1="-1" x2="774" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="756" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="172,173">如何处理3D Secure：PaymentIntent触发requires_action → 客户端调用handleCardAction → 再次确认支付</p></div></div></foreignObject></g><g data-depth="4" data-path="1.84.85.88" class="markmap-node" transform="translate(553, 749.5078125)"><line stroke="#17becf" stroke-width="1.1875" x1="-1" x2="744" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="726" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="174,175">Webhook签名验证：提取Stripe-Signature → 用Webhook密钥、时间戳、事件数据校验签名，防止伪造</p></div></div></foreignObject></g><g data-depth="4" data-path="1.84.85.89" class="markmap-node" transform="translate(553, 776.6953125)"><line stroke="#1f77b4" stroke-width="1.1875" x1="-1" x2="602" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="584" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="176,177">如何实现幂等性：调用API时携带idempotency_key，保证重复调用不产生重复业务</p></div></div></foreignObject></g><g data-depth="4" data-path="1.84.85.90" class="markmap-node" transform="translate(553, 803.8828125)"><line stroke="#ff7f0e" stroke-width="1.1875" x1="-1" x2="773" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="755" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="178,179">订阅升级按比例计费：使用proration策略，默认create_prorations，按剩余周期比例计算差价，可预览费用</p></div></div></foreignObject></g><g data-depth="3" data-path="1.84.85" class="markmap-node" transform="translate(336, 749.5078125)"><line stroke="#e377c2" stroke-width="1.375" x1="-1" x2="139" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#e377c2" fill="var(--markmap-circle-open-bg)" cx="137" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="121" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">9.1 必问核心问题</div></div></foreignObject></g><g data-depth="4" data-path="1.84.91.92" class="markmap-node" transform="translate(569, 836.0703125)"><line stroke="#d62728" stroke-width="1.1875" x1="-1" x2="637" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="619" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="182,183">支付流程：创建PaymentIntent → 确认 → 处理（需验证则处理3D Secure）→ 成功/失败</p></div></div></foreignObject></g><g data-depth="4" data-path="1.84.91.93" class="markmap-node" transform="translate(569, 863.2578125)"><line stroke="#9467bd" stroke-width="1.1875" x1="-1" x2="460" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="442" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="184,185">Webhook：签名验证 → 幂等去重 → 异步处理 → 适配重试机制</p></div></div></foreignObject></g><g data-depth="4" data-path="1.84.91.94" class="markmap-node" transform="translate(569, 890.4453125)"><line stroke="#8c564b" stroke-width="1.1875" x1="-1" x2="657" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="639" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="186,187">订阅：Product→Price→Subscription→Invoice→Payment，核心控制proration和计费周期</p></div></div></foreignObject></g><g data-depth="4" data-path="1.84.91.95" class="markmap-node" transform="translate(569, 917.6328125)"><line stroke="#e377c2" stroke-width="1.1875" x1="-1" x2="557" y1="21.59375" y2="21.59375"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="539" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">
<p data-lines="188,189">安全：密钥环境存储、PCI合规用Elements、幂等性防重复、签名验证防伪造</p></div></div></foreignObject></g><g data-depth="3" data-path="1.84.91" class="markmap-node" transform="translate(336, 876.8515625)"><line stroke="#2ca02c" stroke-width="1.375" x1="-1" x2="155" y1="21.6875" y2="21.6875"/><circle stroke-width="1.5" r="6" stroke="#2ca02c" fill="var(--markmap-circle-open-bg)" cx="153" cy="21.6875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="137" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">9.2 核心关键点记忆</div></div></foreignObject></g><g data-depth="2" data-path="1.84" class="markmap-node" transform="translate(80, 813.1796875)"><line stroke="#8c564b" stroke-width="1.75" x1="-1" x2="178" y1="21.875" y2="21.875"/><circle stroke-width="1.5" r="6" stroke="#8c564b" fill="var(--markmap-circle-open-bg)" cx="176" cy="21.875"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="160" height="21"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml">九、面试高频必背总结</div></div></foreignObject></g><g data-depth="1" data-path="1" class="markmap-node" transform="translate(0,0)"><line stroke="#1f77b4" stroke-width="2.5" x1="-1" x2="2" y1="1.25" y2="1.25"/><foreignObject class="markmap-foreign" x="8" y="0" style="opacity: 1;" width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml"><div xmlns="http://www.w3.org/1999/xhtml"></div></div></foreignObject><circle stroke-width="1.5" r="6" stroke="#1f77b4" fill="var(--markmap-circle-open-bg)" cx="0" cy="1.25"/></g></g></svg>